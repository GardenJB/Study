## SQL Server

- DBMS
    - 대용량의 데이터 집합을 체계적을 구성해 놓은 것(DB)을 관리하는 소프트웨어
    - 데이터베이스 관리 시스템
    - 동시접속 및 데이터 공유 ⭐

- 무결성(제약조건) / 독립성 / 보안 / 중복 최소화 / 응용 프로그램 제작 및 수정 용이 / 안전성(백업,복원)
- SQL 공유

- 분류
    - 계층형
        - 트리형
        - 1:n
        - 주어진 상태 검색 빠르
        - 임의 검색과 같은 접근 유연성 부족 / 구조 변경 어려움
    - 망형
        - 다대다 관계 지원
        - 구조 복잡
    - 관계형 ✅
        - 테이블 구조(릴레이션 / 엔티티)
            - 행
            - 열
        - 변화 순응 쉽 / 유지보수 편리
        - 대용량 데이터 관리 / 무결성 보장
        - 시스템 자원 많이 소비
    - 객체지향형
    - 객체관계형
    
- SQL
    - 관계형 데이터베이스에서 사용하는 언어 (DB소통)
    - DBMS 제작회사와 독립적(표준 SQL)
    - 이식성 용이
    - 표준 발전
    - 대화식 언어
    - 분산형 클라이언트 - 서버 구조

- SQL Server
    - MSSQL < MS사
    - 표준SQL + T-SQL 추가

- CTP > 베타 버전 / 커뮤니티 테스트
- RTP > 정식 버전 / 공급 최종 버전 확인

- SQL Server + 인메모리 DB + 보안 및 성능
- 신뢰성 / 생산성 / 지능적

- TDE 자체 데이터 암호화
- 데이터 압축 / 백업 압축 제공
- DATE 추가
- FILESTREAM 데이터 FILETABLE
- 공간 데이터 타입 추가
- AlwaysOn
    - 고가용성 솔루션
    - 데이터베이스 자체의 문제 해결을 위한 솔루션
- 클라우드 확장
- 분석

## SQL Server 설치

```
1. 다운로드 / 설치
	* 윈도우 업데이트
	* 제어판 > 프로그램 및 기능 > 윈도우 기능 켜기/끄기 > .NET 3.5 체크

	* MS SQL Server Downloda / 로그인 필요
	* setup.exe
  * 설치 > 새 SQL Server 독립 설치 / 제품 키 입력
	* 기능 선택 > 데이터베이스 엔진 서비스 / 검색을 위한 전체 텍스트... / 클라이언트 도구 연결   체크
	* 데이터베이스 엔진 구성 > 현재 사용자 추가 클릭 및 관리자 추가 확인
	
2. 관리 도구 설치 SSMS(SQL Server Manage Studio)
	* 서버 관리자 / 구성 관리자

3.서버 접속 연결
	* 접속 실패시 > 구성 관리자 > sql server 서비스 > SQL Server > 마우스 우클릭 > 시작

4. sample db 설치 
	* MS adventureWorks Databases ... down
	* 파일 Backup 폴더로 이동
	* 데이터베이스 복원 >  장치 추가

** SQL Server 추가 인스턴스
** 서비스 팩 설치/업데이트
** 프로파일러 > 최적화
```

## SQL

```sql
-- 요구사항 분석 / 시스템 설계 및 모델링
 * 정보시스템 구축 : 분석, 설계, 구현, 시험, 유지보수
 * 설계 - 데이터베이스 모델링 및 용어
		> 테이블 형식
		< 데이터 > 데이터베이스(테이블 : 행<데이터 수>, 열<데이터 형식>) > DB 관리 시스템
			* 기본 키(중복 x, not null) PK / 외래키 FK
	 
		> 인덱스, 저장 프로시저, 함수, 트리거, 커서 ...

-- SQL
	* 구조화된 질의 언어 > DB와 소통

	* CHAR(영문만 숫자/기호 포함) / NCHAR(한글포함)
	
	```
		
		** 새 쿼리 생성 및 DB 위치 확인 후
		USE 디비명;
		
	```

	** GO > 이전 문장 완전 종료, 이후 문장 완전히 새로운 시작

	** 테이블 안 보임 > 새로고침

-- 인덱스
	* 특정 키워드로 데이터 검색

	CREATE INDEX 인덱스테이블명 ON 인덱스명;
		> 실행계획 확인 : 인덱스 참조

	((
	SELECT ... INTO Table
		FROM DB
	Go
	SELECT * FROM Table
))

-- 뷰
	* 가상의 테이블 (뷰 테이블)
	* 진짜 테이블에 링크된 개념
		> 보안상 유출 문제 임시로 우회 (실제 테이블 x / 필요한 정보 테이블에만 접근 가능하게 함)
			: 부분적 데이터에만 접근 가능하게 임시테이블 형성

	CREATE VIEW viewtable
	AS
		SELECT ... From table
	GO
	SELECT ... FROM viewtable

-- 저장 프로시저
	* 프로그래밍 기능

	CREATE PROCEDURE 프로시저명
	AS
		구문1 ...
		구문2 ...
		...
	GO

	EXECUTE 프로시저명;

-- 트리거
	* 테이블에 부착되어 INSERT / UPDATE / DELETE 작업 발생시 실행되는 코드

	// 임시 데이터 저장 테이블 생성
	// 트리거 생성
	CREATE TRIGGER 트리거명
	ON 부착테이블
	AFTER DELETE **원하는 이벤트 발생 겨우
	AS
		원하는 작업 구문 ...
	
-- 데이터베이스 백업 및 관리
	* 데이터베이스를 `다른 매체`에 저장 / 이를 이용 원상태로 복원

	// 백업 저장 공간 확보
	// 데이터베이스 백업
	> 데이터베이스 우클릭 > 테스크 > 백업

	* 복원 대상 디비에서 복원 x
	USE 다른디비 // 이동
	> 데이터베이스 우클릭 > 데이터베이스 복원 > 재시작

-- 온라인 도움말
	* 도움말 설치 > 콘텐츠 관리 > 추가/업데이트
	* 인덱스 > 키워드 검색
  * 검색 > 키원드 검색 

-- SQL Server 응용 프로그램 연결

```

## DB 모델링

```sql
: 데이터베이스 설계

1. 개념적 모델링
2. 논리적 모델링
3. 물리적 모델링

* 객체뿐만 아니라 행위도 테이블 생성 대상
* 자원 낭비 막기위해 > 테이블 분리 (빈 공간 / 중복)
* 관계 설정 - PK / FK / n:n
 >> 테이블 정의서 작성 (테이블명/ 열명 / 데이터타입 / null 여부...)

```

## SQL Server 툴/유틸리티

```sql
* SSMS  SQL 서버 엔진에 접속하기 위한 클라이언트 도구

* 개체 탐색기
	-  테이블 우클릭 > 테이블 스크립창 > CREATE > 새쿼리 편집기 창

* 쿼리창
	: SQL구문 입력하고 샐행하는 텍스트 에디터

- 코드 조각 생성
- 코드 감싸기...

	** 표 형태로 결과 표시 ctrl + D
	** 텍스트 형태로 결과표시 ctrl +T  >> 복사 가능
	** 파일로 내보내기 > 우클릭 복사(머리글 포함)

** 실행 계획 ⭐⭐ + 통계
	: 내부적 작동 방식 확인  ctrl + M

* 디버깅
	F11 > 한줄 실행

* 프로파일러
		: 이벤트 추적 및 수집  > 성능 확인
```